{{ define "main" }}

<div class="fdc-content-layout bg-black text-light-grey">
    <section>
        {{ with .Content }}
        {{ . }}
        {{ end }}
    </section>
    <section>
        <div class="self-start pt-20 md:pt-32">
            {{- partial "footer-legal.html" . -}}
        </div>
    </section>
</div>

{{ end }}

{{ define "page_script" }}
<script>
    const observer = new MutationObserver(function(mutations_list) {
        mutations_list.forEach(function(mutation) {
            mutation.addedNodes.forEach(function(added_node) {
                if(added_node.id === 'CookieDeclarationUserStatusPanel') {

                    // add styles and arrows to buttons
                    const cookieDeclarationChangeConsent = document.querySelectorAll('#CookieDeclarationChangeConsent a');
                    for (let i = 0; i < cookieDeclarationChangeConsent.length; i++) {
                        cookieDeclarationChangeConsent[i].innerHTML = '<span>' + cookieDeclarationChangeConsent[i].innerHTML + '</span>';
                    }

                    // create button to show cookie settings
                    const openCookieSettingsButton = document.createElement('a');
                    openCookieSettingsButton.innerHTML = '<span>Show cookie settings</span>';
                    openCookieSettingsButton.className = 'fdc-btn-link--yellow';
                    openCookieSettingsButton.addEventListener('click', function (e) {
                        e.preventDefault();
                        // show all cookie settings tables
                        const cookieDeclarationSections = document.getElementsByClassName('CookieDeclarationType');
                        for (let i = 0; i < cookieDeclarationSections.length; i++) {
                            cookieDeclarationSections[i].classList.add('visible');
                        }
                        openCookieSettingsButton.remove();
                    });

                    // attach button to content
                    const target = document.getElementsByClassName("CookieDeclarationLastUpdated")[0];
                    target.replaceWith(openCookieSettingsButton);

                    observer.disconnect();
                }
            });
        });
    });
    observer.observe(document.querySelector(".CookieDeclaration"), { subtree: false, childList: true });
</script>
{{ end }}